<!DOCTYPE html>
<html lang="en">
<head>
    <link rel="stylesheet" href="styles.css">
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>weblayout.com</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css" integrity="sha512-DTOQO9RWCH3ppGqcWaEA1BIZOC6xxalwEsw9c2QQeAIftl+Vegovlnee1c9QX4TctnWMn13TZye+giMm8e2LwA==" crossorigin="anonymous" referrerpolicy="no-referrer" />

    </head>


<body>
    <section>
    <div class="div1">
        <div class="div2">
            <header>Sign up</header>
            <form>
                <p id="demo"></p>
                <p id="code"></p>
                <legend class="username">Username</legend>
                <i class="fa-solid fa-user-tie" style="color: deepskyblue;" >
                    <input id="username" class="user" type="text" name="Username" placeholder="Type your username"></i>

                <legend class="password">Password</legend>
                <i class="fa fa-lock" style="color: deepskyblue;">
                    <input id="password" class="pass" type="password" name="password" placeholder="Type your password"></i>

                    <p id="incorrect"></p>

                    <legend class="password">confirm password</legend>
                    <i class="fa fa-lock" style="color: deepskyblue;">
                        <input id="confirms" class="pass" type="password" name="password" placeholder="confirm password"></i>


                <button class="button1" type="menu">Forgotten password?</button>

                    <input type="submit" value="Login " id="submit" class="submit">   

                <span class="span1">Or Sign Up Using</span>
                
                <div class="icons">
                    <a href="#"><i class="fa-brands fa-facebook"></i></a>
                    <a href="#"><i class="fa-brands fa-twitter"></i></a>
                    <a href="#"><i class="fa-brands fa-google"></i></a>
                </div>
            </form>
        </div>
    </div>
</section>
    <!-- <a href="banner.html">Other side</a> -->

    <script>

        //working with DOM
        const errName  =document.querySelector("#demo")
        const incorrectErr = document.querySelector("#incorrect")
        const errPass  =document.querySelector("#code")
        const push = document.getElementById("submit")

        //listening to the event
        push.addEventListener("click", async e => {
            const confirms = document.getElementById("confirms").value;
            const user = document.getElementById("username").value;
            const pass = document.getElementById("password").value;
            e.preventDefault();

            //assining logic verification to the password an username
            if(user.includes("@gmail.com") && user.indexOf(" ") === -1){
                if(pass.length > 5 && pass.indexOf( " ") ===-1){
                  if(confirms === pass){
                     alert("Valid credentials");
                    window.location.href = "/logs/banner.html";
                  }
                  else{
                      incorrectErr.textContent = "incorrect password";
                      incorrectErr.classList.add("checker");
                  }
                  
                }
                else{
                   errPass.textContent = "Password too short or include gap";
                   errPass.classList.add("checker");
                }
               }
               else{
               errName.textContent = "Username must end with @gmail.com or include gap";
               errName.classList.add("checker");
             }

             //creating a POST Api
            const data = {user, confirms};
            const opt = {
                method: "POST",
                headers: {"Content-Type":"application/json"},
                body:JSON.stringify(data)
            };
            const response = await fetch("/signup", opt);

            //Api error handler
            if(response.ok){
                alert("signup successful");
            }
            else{
                alert("errormessage")
            }
            
        });
    </script>
</body>
</html>
